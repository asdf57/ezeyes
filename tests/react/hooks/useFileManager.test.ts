import '@testing-library/jest-dom';
import * as ipc from '../../../src/electron/ipc';
import { read, readDocx, readPdf, spawnFileDialog } from '../../../src/electron/ipc';

beforeEach(() => {
	jest.clearAllMocks();
});

import { trimWhitespace, processRTFContent, loadRtfFile } from  '../../../src/react/hooks/useFileManager';

//Encode as base 64 to circumvent typescript raw string compile-time issues
const rtfText1: string = "e1xydGYxXGFuc2lcZGVmZjNcYWRlZmxhbmcxMDI1CntcZm9udHRibHtcZjBcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MCBUaW1lcyBOZXcgUm9tYW47fXtcZjFcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MiBTeW1ib2w7fXtcZjJcZnN3aXNzXGZwcnEyXGZjaGFyc2V0MCBBcmlhbDt9e1xmM1xmcm9tYW5cZnBycTJcZmNoYXJzZXQwIExpYmVyYXRpb24gU2VyaWZ7XCpcZmFsdCBUaW1lcyBOZXcgUm9tYW59O317XGY0XGZzd2lzc1xmcHJxMlxmY2hhcnNldDAgTGliZXJhdGlvbiBTYW5ze1wqXGZhbHQgQXJpYWx9O317XGY1XGZuaWxcZnBycTJcZmNoYXJzZXQwIFBpbmdGYW5nIFNDO317XGY2XGZzd2lzc1xmcHJxMFxmY2hhcnNldDEyOCBBcmlhbCBVbmljb2RlIE1TO317XGY3XGZuaWxcZnBycTJcZmNoYXJzZXQwIEFyaWFsIFVuaWNvZGUgTVM7fX0Ke1xjb2xvcnRibDtccmVkMFxncmVlbjBcYmx1ZTA7XHJlZDBcZ3JlZW4wXGJsdWUyNTU7XHJlZDBcZ3JlZW4yNTVcYmx1ZTI1NTtccmVkMFxncmVlbjI1NVxibHVlMDtccmVkMjU1XGdyZWVuMFxibHVlMjU1O1xyZWQyNTVcZ3JlZW4wXGJsdWUwO1xyZWQyNTVcZ3JlZW4yNTVcYmx1ZTA7XHJlZDI1NVxncmVlbjI1NVxibHVlMjU1O1xyZWQwXGdyZWVuMFxibHVlMTI4O1xyZWQwXGdyZWVuMTI4XGJsdWUxMjg7XHJlZDBcZ3JlZW4xMjhcYmx1ZTA7XHJlZDEyOFxncmVlbjBcYmx1ZTEyODtccmVkMTI4XGdyZWVuMFxibHVlMDtccmVkMTI4XGdyZWVuMTI4XGJsdWUwO1xyZWQxMjhcZ3JlZW4xMjhcYmx1ZTEyODtccmVkMTkyXGdyZWVuMTkyXGJsdWUxOTI7fQp7XHN0eWxlc2hlZXR7XHMwXHNuZXh0MFxydGxjaFxhZjdcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyIE5vcm1hbDt9CntcczE1XHNiYXNlZG9uMFxzbmV4dDE2XHJ0bGNoXGFmN1xhZnMyOCBcbHRyY2hcaGljaFxhZjRcbG9jaFxzYjI0MFxzYTEyMFxrZWVwblxmNFxmczI4XGRiY2hcYWY1IEhlYWRpbmc7fQp7XHMxNlxzYmFzZWRvbjBcc25leHQxNlxsb2NoXHNsMjc2XHNsbXVsdDFcc2IwXHNhMTQwIEJvZHkgVGV4dDt9CntcczE3XHNiYXNlZG9uMTZcc25leHQxN1xydGxjaFxhZjYgXGx0cmNoXGxvY2hcc2wyNzZcc2xtdWx0MVxzYjBcc2ExNDAgTGlzdDt9CntcczE4XHNiYXNlZG9uMFxzbmV4dDE4XHJ0bGNoXGFmNlxhZnMyNFxhaSBcbHRyY2hcbG9jaFxzYjEyMFxzYTEyMFxub2xpbmVcZnMyNFxpIENhcHRpb247fQp7XHMxOVxzYmFzZWRvbjBcc25leHQxOVxydGxjaFxhZjYgXGx0cmNoXGxvY2hcbm9saW5lIEluZGV4O30KfXtcKlxnZW5lcmF0b3IgTGlicmVPZmZpY2UvMjQuMi4wLjMkTWFjT1NYX0FBUkNINjQgTGlicmVPZmZpY2VfcHJvamVjdC9kYTQ4NDg4YTczZGRkNjZlYTI0Y2YxNmJiYzRmN2I5YzA4ZTliZWExfXtcaW5mb3tcY3JlYXRpbVx5cjIwMjRcbW8yXGR5MjZcaHIxNlxtaW4xOX17XHJldnRpbVx5cjIwMjRcbW8yXGR5MjZcaHIxNlxtaW4xOX17XHByaW50aW1ceXIwXG1vMFxkeTBcaHIwXG1pbjB9fXtcKlx1c2VycHJvcHN9XGRlZnRhYjcwOQpcaHlwaGF1dG8xXHZpZXdzY2FsZTYwXGZvcm1zaGFkZVxub2Jya3dycHRibFxwYXBlcmgxNTg0MFxwYXBlcncxMjI0MFxtYXJnbDExMzRcbWFyZ3IxMTM0XG1hcmd0MTEzNFxtYXJnYjExMzRcc2VjdGRcc2Jrbm9uZVxzZnRubmFyXHNhZnRubnJsY1xzZWN0dW5sb2NrZWQxXHBnd3N4bjEyMjQwXHBnaHN4bjE1ODQwXG1hcmdsc3huMTEzNFxtYXJncnN4bjExMzRcbWFyZ3RzeG4xMTM0XG1hcmdic3huMTEzNFxmdG5ialxmdG5zdGFydDFcZnRucnN0Y29udFxmdG5uYXJcYWVuZGRvY1xhZnRucnN0Y29udFxhZnRuc3RhcnQxXGFmdG5ucmxjCntcKlxmdG5zZXBcY2hmdG5zZXB9XHBnbmRlY1xwYXJkXHBsYWluIFxzMFxydGxjaFxhZjdcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFsXGx0cnBhcntcbG9jaApUaGlzfQpccGFyIH0=";
const rtfText2: string = "e1xydGYxXGFuc2lcZGVmZjNcYWRlZmxhbmcxMDI1CntcZm9udHRibHtcZjBcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MCBUaW1lcyBOZXcgUm9tYW47fXtcZjFcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MiBTeW1ib2w7fXtcZjJcZnN3aXNzXGZwcnEyXGZjaGFyc2V0MCBBcmlhbDt9e1xmM1xmcm9tYW5cZnBycTJcZmNoYXJzZXQwIExpYmVyYXRpb24gU2VyaWZ7XCpcZmFsdCBUaW1lcyBOZXcgUm9tYW59O317XGY0XGZyb21hblxmcHJxMlxmY2hhcnNldDAgTHVtaW5hcmk7fXtcZjVcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MCBMaWJlcmF0aW9uIFNhbnN7XCpcZmFsdCBBcmlhbH07fXtcZjZcZnJvbWFuXGZwcnEyXGZjaGFyc2V0MCBMYW50aW5naGVpIFRDO317XGY3XGZuaWxcZnBycTJcZmNoYXJzZXQwIFBpbmdGYW5nIFNDO317XGY4XGZuaWxcZnBycTJcZmNoYXJzZXQwIDA7fXtcZjlcZm5pbFxmcHJxMlxmY2hhcnNldDAgQXJpYWwgVW5pY29kZSBNUzt9fQp7XGNvbG9ydGJsO1xyZWQwXGdyZWVuMFxibHVlMDtccmVkMFxncmVlbjBcYmx1ZTI1NTtccmVkMFxncmVlbjI1NVxibHVlMjU1O1xyZWQwXGdyZWVuMjU1XGJsdWUwO1xyZWQyNTVcZ3JlZW4wXGJsdWUyNTU7XHJlZDI1NVxncmVlbjBcYmx1ZTA7XHJlZDI1NVxncmVlbjI1NVxibHVlMDtccmVkMjU1XGdyZWVuMjU1XGJsdWUyNTU7XHJlZDBcZ3JlZW4wXGJsdWUxMjg7XHJlZDBcZ3JlZW4xMjhcYmx1ZTEyODtccmVkMFxncmVlbjEyOFxibHVlMDtccmVkMTI4XGdyZWVuMFxibHVlMTI4O1xyZWQxMjhcZ3JlZW4wXGJsdWUwO1xyZWQxMjhcZ3JlZW4xMjhcYmx1ZTA7XHJlZDEyOFxncmVlbjEyOFxibHVlMTI4O1xyZWQxOTJcZ3JlZW4xOTJcYmx1ZTE5MjtccmVkMjAxXGdyZWVuMzNcYmx1ZTMwO30Ke1xzdHlsZXNoZWV0e1xzMFxzbmV4dDBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MiBOb3JtYWw7fQp7XCpcY3MxNVxzbmV4dDE1IE51bWJlcmluZyBTeW1ib2xzO30Ke1wqXGNzMTZcc25leHQxNiBMaXN0TGFiZWwgMTt9CntcKlxjczE3XHNuZXh0MTcgTGlzdExhYmVsIDI7fQp7XCpcY3MxOFxzbmV4dDE4IExpc3RMYWJlbCAzO30Ke1wqXGNzMTlcc25leHQxOSBMaXN0TGFiZWwgNDt9CntcKlxjczIwXHNuZXh0MjAgTGlzdExhYmVsIDU7fQp7XCpcY3MyMVxzbmV4dDIxIExpc3RMYWJlbCA2O30Ke1wqXGNzMjJcc25leHQyMiBMaXN0TGFiZWwgNzt9CntcKlxjczIzXHNuZXh0MjMgTGlzdExhYmVsIDg7fQp7XCpcY3MyNFxzbmV4dDI0IExpc3RMYWJlbCA5O30Ke1wqXGNzMjVcc25leHQyNSBMaXN0TGFiZWwgMTA7fQp7XCpcY3MyNlxzbmV4dDI2IExpc3RMYWJlbCAxMTt9CntcKlxjczI3XHNuZXh0MjcgTGlzdExhYmVsIDEyO30Ke1wqXGNzMjhcc25leHQyOCBMaXN0TGFiZWwgMTM7fQp7XCpcY3MyOVxzbmV4dDI5IExpc3RMYWJlbCAxNDt9CntcKlxjczMwXHNuZXh0MzAgTGlzdExhYmVsIDE1O30Ke1wqXGNzMzFcc25leHQzMSBMaXN0TGFiZWwgMTY7fQp7XCpcY3MzMlxzbmV4dDMyIExpc3RMYWJlbCAxNzt9CntcKlxjczMzXHNuZXh0MzMgTGlzdExhYmVsIDE4O30Ke1xzMzRcc2Jhc2Vkb24wXHNuZXh0MzVccnRsY2hcYWY5XGFmczI4XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmNVxsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxzYjI0MFxzYTEyMFxrZWVwblxsdHJwYXJcY2YwXGY1XGZzMjhcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjdcbGFuZ2ZlMjA1MiBIZWFkaW5nO30Ke1xzMzVcc2Jhc2Vkb24wXHNuZXh0MzVccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHNsMjc2XHNsbXVsdDFcd2lkY3RscGFyXGh5cGhwYXIwXHNiMFxzYTE0MFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MiBCb2R5IFRleHQ7fQp7XHMzNlxzYmFzZWRvbjM1XHNuZXh0MzZccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHNsMjc2XHNsbXVsdDFcd2lkY3RscGFyXGh5cGhwYXIwXHNiMFxzYTE0MFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MiBMaXN0O30Ke1xzMzdcc2Jhc2Vkb24wXHNuZXh0MzdccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MVxhaSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxzYjEyMFxzYTEyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNcaVxrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyIENhcHRpb247fQp7XHMzOFxzYmFzZWRvbjBcc25leHQzOFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyIEluZGV4O30KfXtcKlxsaXN0dGFibGV7XGxpc3RcbGlzdHRlbXBsYXRlaWQxCntcbGlzdGxldmVsXGxldmVsbmZjMFxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MHtcbGV2ZWx0ZXh0IFwnMDJcJzAwLjt9e1xsZXZlbG51bWJlcnNcJzAxO31cZmktMzYwXGxpNzIwfQp7XGxpc3RsZXZlbFxsZXZlbG5mYzBcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzB7XGxldmVsdGV4dCBcJzAyXCcwMS47fXtcbGV2ZWxudW1iZXJzXCcwMTt9XGZpLTM2MFxsaTEwODB9CntcbGlzdGxldmVsXGxldmVsbmZjMFxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MHtcbGV2ZWx0ZXh0IFwnMDJcJzAyLjt9e1xsZXZlbG51bWJlcnNcJzAxO31cZmktMzYwXGxpMTQ0MH0Ke1xsaXN0bGV2ZWxcbGV2ZWxuZmMwXGxldmVsamMwXGxldmVsc3RhcnRhdDFcbGV2ZWxmb2xsb3cwe1xsZXZlbHRleHQgXCcwMlwnMDMuO317XGxldmVsbnVtYmVyc1wnMDE7fVxmaS0zNjBcbGkxODAwfQp7XGxpc3RsZXZlbFxsZXZlbG5mYzBcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzB7XGxldmVsdGV4dCBcJzAyXCcwNC47fXtcbGV2ZWxudW1iZXJzXCcwMTt9XGZpLTM2MFxsaTIxNjB9CntcbGlzdGxldmVsXGxldmVsbmZjMFxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MHtcbGV2ZWx0ZXh0IFwnMDJcJzA1Ljt9e1xsZXZlbG51bWJlcnNcJzAxO31cZmktMzYwXGxpMjUyMH0Ke1xsaXN0bGV2ZWxcbGV2ZWxuZmMwXGxldmVsamMwXGxldmVsc3RhcnRhdDFcbGV2ZWxmb2xsb3cwe1xsZXZlbHRleHQgXCcwMlwnMDYuO317XGxldmVsbnVtYmVyc1wnMDE7fVxmaS0zNjBcbGkyODgwfQp7XGxpc3RsZXZlbFxsZXZlbG5mYzBcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzB7XGxldmVsdGV4dCBcJzAyXCcwNy47fXtcbGV2ZWxudW1iZXJzXCcwMTt9XGZpLTM2MFxsaTMyNDB9CntcbGlzdGxldmVsXGxldmVsbmZjMFxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MHtcbGV2ZWx0ZXh0IFwnMDJcJzA4Ljt9e1xsZXZlbG51bWJlcnNcJzAxO31cZmktMzYwXGxpMzYwMH1cbGlzdGlkMX0Ke1xsaXN0XGxpc3R0ZW1wbGF0ZWlkMgp7XGxpc3RsZXZlbFxsZXZlbG5mYzI1NVxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MntcbGV2ZWx0ZXh0IFwnMDA7fXtcbGV2ZWxudW1iZXJzO31cZmkwXGxpMH0Ke1xsaXN0bGV2ZWxcbGV2ZWxuZmMyNTVcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzJ7XGxldmVsdGV4dCBcJzAwO317XGxldmVsbnVtYmVyczt9XGZpMFxsaTB9CntcbGlzdGxldmVsXGxldmVsbmZjMjU1XGxldmVsamMwXGxldmVsc3RhcnRhdDFcbGV2ZWxmb2xsb3cye1xsZXZlbHRleHQgXCcwMDt9e1xsZXZlbG51bWJlcnM7fVxmaTBcbGkwfQp7XGxpc3RsZXZlbFxsZXZlbG5mYzI1NVxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MntcbGV2ZWx0ZXh0IFwnMDA7fXtcbGV2ZWxudW1iZXJzO31cZmkwXGxpMH0Ke1xsaXN0bGV2ZWxcbGV2ZWxuZmMyNTVcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzJ7XGxldmVsdGV4dCBcJzAwO317XGxldmVsbnVtYmVyczt9XGZpMFxsaTB9CntcbGlzdGxldmVsXGxldmVsbmZjMjU1XGxldmVsamMwXGxldmVsc3RhcnRhdDFcbGV2ZWxmb2xsb3cye1xsZXZlbHRleHQgXCcwMDt9e1xsZXZlbG51bWJlcnM7fVxmaTBcbGkwfQp7XGxpc3RsZXZlbFxsZXZlbG5mYzI1NVxsZXZlbGpjMFxsZXZlbHN0YXJ0YXQxXGxldmVsZm9sbG93MntcbGV2ZWx0ZXh0IFwnMDA7fXtcbGV2ZWxudW1iZXJzO31cZmkwXGxpMH0Ke1xsaXN0bGV2ZWxcbGV2ZWxuZmMyNTVcbGV2ZWxqYzBcbGV2ZWxzdGFydGF0MVxsZXZlbGZvbGxvdzJ7XGxldmVsdGV4dCBcJzAwO317XGxldmVsbnVtYmVyczt9XGZpMFxsaTB9CntcbGlzdGxldmVsXGxldmVsbmZjMjU1XGxldmVsamMwXGxldmVsc3RhcnRhdDFcbGV2ZWxmb2xsb3cye1xsZXZlbHRleHQgXCcwMDt9e1xsZXZlbG51bWJlcnM7fVxmaTBcbGkwfVxsaXN0aWQyfQp9e1xsaXN0b3ZlcnJpZGV0YWJsZXtcbGlzdG92ZXJyaWRlXGxpc3RpZDFcbGlzdG92ZXJyaWRlY291bnQwXGxzMX17XGxpc3RvdmVycmlkZVxsaXN0aWQyXGxpc3RvdmVycmlkZWNvdW50MFxsczJ9fXtcKlxnZW5lcmF0b3IgTGlicmVPZmZpY2UvMjQuMi4wLjMkTWFjT1NYX0FBUkNINjQgTGlicmVPZmZpY2VfcHJvamVjdC9kYTQ4NDg4YTczZGRkNjZlYTI0Y2YxNmJiYzRmN2I5YzA4ZTliZWExfXtcaW5mb3tcY3JlYXRpbVx5cjIwMjRcbW8yXGR5MjJcaHIxNlxtaW4xMn17XHJldnRpbVx5cjIwMjRcbW8yXGR5MjJcaHIxNlxtaW4zMH17XHByaW50aW1ceXIwXG1vMFxkeTBcaHIwXG1pbjB9fXtcKlx1c2VycHJvcHN9XGRlZnRhYjcwOQpcaHlwaGF1dG8xXHZpZXdzY2FsZTU1XGZvcm1zaGFkZVxub2Jya3dycHRibFxwYXBlcmgxNTg0MFxwYXBlcncxMjI0MFxtYXJnbDExMzRcbWFyZ3IxMTM0XG1hcmd0MTEzNFxtYXJnYjExMzRcc2VjdGRcc2Jrbm9uZVxzZnRubmFyXHNhZnRubnJsY1xzZWN0dW5sb2NrZWQxXHBnd3N4bjEyMjQwXHBnaHN4bjE1ODQwXG1hcmdsc3huMTEzNFxtYXJncnN4bjExMzRcbWFyZ3RzeG4xMTM0XG1hcmdic3huMTEzNFxmdG5ialxmdG5zdGFydDFcZnRucnN0Y29udFxmdG5uYXJcYWVuZGRvY1xhZnRucnN0Y29udFxhZnRuc3RhcnQxXGFmdG5ucmxjCntcKlxmdG5zZXBcY2hmdG5zZXB9XHBnbmRlY1xwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xsb2NoXGNmMVxsb2NoClRoaXMgaXMgYSB0ZXN0IX0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxbFxsb2NoXGNmMVxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xydGxjaFxhZnM0MiBcbHRyY2hcbG9jaFxjZjFcZnM0Mlxsb2NoCkZvbnQgc2l6ZX0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxbFxsb2NoXGNmMVxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xsb2NoXGNmMVxjaGNicGF0N1xsb2NoCmhpZ2hsaWdodH0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxbFxsb2NoXGNmMVxjaGNicGF0N1xsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xsb2NoXGNmMTdcbG9jaApjb2xvcmVkIHRleHR9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWxcbG9jaFxjZjE3XGxvY2gKClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWx7XHJ0bGNoXGFiIFxsdHJjaFxsb2NoXGNmMVxiXGxvY2gKQk9MRH0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxbFxydGxjaFxhYiBcbHRyY2hcbG9jaFxjZjFcYlxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xydGxjaFxhaVxhYjAgXGx0cmNoXGxvY2hcY2YxXGlcYjBcbG9jaApJdGFsaWNpemVkfQpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFsXHJ0bGNoXGFpXGFiMCBcbHRyY2hcbG9jaFxjZjFcaVxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xydGxjaFxhaTBcYWIwIFxsdHJjaFxoaWNoXGFmNFxsb2NoXGNmMVxpMFxiMFxmNFxsb2NoCk5ldyBmb250fQpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFsXHJ0bGNoXGFpXGFiMCBcbHRyY2hcbG9jaFxjZjFcaVxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bFx1bGMwXGIwXGxvY2gKVW5kZXJsaW5lZCB9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWxccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxcdWxjMFxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFse1xydGxjaFxhaTBcYWIgXGx0cmNoXGxvY2hcY2YxXGkwXHVsbm9uZVx1bGMwXGJcbG9jaApFZHdhcmR9e1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCiBieSB0aGUgfXtccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxcdWxjMFxiMFxsb2NoCmdyYWNlIG9mIEdvZCBLaW5nIG9mIEVuZ2xhbmQsIGxvcmQgb2YgSXJlbGFuZCBhbmQgZHVrZSBvZiBBcXVpdGFpbmUgc2VuZHMgZ3JlZXRpbmdzIH17XHJ0bGNoXGFpMFxhYjAgXGx0cmNoXGxvY2hcY2YxXGkwXHVsbm9uZVx1bGMwXGIwXGxvY2gKdG8gYWxsIHRvIHdob20gdGhlIHByZXNlbnQgbGV0dGVycyBjb21lLiBXZSBoYXZlIGluc3BlY3RlZCB0aGUgZ3JlYXQgY2hhcnRlciBvZiB0aGUgbG9yZCBIZW5yeSwgbGF0ZSBLaW5nIG9mIEVuZ2xhbmQsIG91ciBmYXRoZXIsIGNvbmNlcm5pbmcgdGhlIGxpYmVydGllcyBvZiBFbmdsYW5kIGluIHRoZXNlIHdvcmRzOiBIZW5yeSBieSB0aGUgZ3JhY2Ugb2YgR29kIEtpbmcgb2YgRW5nbGFuZCwgbG9yZCBvZiBJcmVsYW5kLCBkdWtlIG9mIE5vcm1hbmR5IGFuZCBBcXVpdGFpbmUgYW5kIGNvdW50IG9mIEFuam91IHNlbmRzIGdyZWV0aW5ncyB0byBoaXMgYXJjaGJpc2hvcHMsIGJpc2hvcHMsIGFiYm90cywgcHJpb3JzLCBlYXJscywgYmFyb25zLCBzaGVyaWZmcywgcmVldmVzLCBtaW5pc3RlcnMgYW5kIGFsbCBoaXMgYmFpbGlmZnMgYW5kIGZhaXRoZnVsIG1lbiBpbnNwZWN0aW5nIHRoZSBwcmVzZW50IGNoYXJ0ZXIuIEtub3cgdGhhdCB3ZSwgYXQgdGhlIHByb21wdGluZyBvZiBHb2QgYW5kIGZvciB0aGUgaGVhbHRoIG9mIG91ciB9e1xydGxjaFxhaTBcYWIwIFxsdHJjaFxoaWNoXGFmNlxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxmNlxsb2NoCnNvdWx9e1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCiBhbmQgdGhlIHNvdWxzIG9mIG91ciBhbmNlc3RvcnMgYW5kIHN1Y2Nlc3NvcnMsIGZvciB0aGUgZ2xvcnkgb2YgaG9seSBDaHVyY2ggYW5kIHRoZSBpbXByb3ZlbWVudCBvZiBvdXIgcmVhbG0sIGZyZWVseSBhbmQgb3V0IG9mIG91ciBnb29kIHdpbGwgaGF2ZSBnaXZlbiBhbmQgZ3JhbnRlZCB0byB0aGUgYXJjaGJpc2hvcHMsIGJpc2hvcHMsIGFiYm90cywgcHJpb3JzLCBlYXJscywgYmFyb25zIGFuZCBhbGwgb2Ygb3VyIHJlYWxtIHRoZXNlIGxpYmVydGllcyB3cml0dGVuIGJlbG93IHRvIGhvbGQgaW4gb3VyIHJlYWxtIG9mIEVuZ2xhbmQgaW4gcGVycGV0dWl0eX0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxbFxydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHFje1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCmNlbnRlciBmb3JtYXR0ZWR9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWNccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxub25lXHVsYzBcYjBcbG9jaAoKXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxxcntccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxub25lXHVsYzBcYjBcbG9jaApSaWdodCBmb3JtYXR0ZWR9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWxcZmkwXGxpNzA5XGxpbjcwOXtccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxub25lXHVsYzBcYjBcbG9jaApJbmRlbnRlZCF9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJccWxcZmkwXGxpNzA5XGxpbjcwOVxydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHNsNDgwXHNsbXVsdDFccWxcZmkwXGxpMFxsaW4we1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCkRvdWJsZSBzcGFjaW5nfQpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHNsMjQwXHNsbXVsdDFccWxcZmkwXGxpMFxsaW4we1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCk51bWJlcmVkIGxpc3Q6fQpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUye1xsaXN0dGV4dFxwYXJkXHBsYWluICAxLlx0YWJ9XGlsdmwwXGxzMSBcZmktMzYwXGxpNzIwXGxpbjcyMFxzbDI0MFxzbG11bHQxXHFse1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCk9uZX0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MntcbGlzdHRleHRccGFyZFxwbGFpbiAgMi5cdGFifVxpbHZsMFxsczEgXGZpLTM2MFxsaTcyMFxsaW43MjBcc2wyNDBcc2xtdWx0MVxxbHtccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxub25lXHVsYzBcYjBcbG9jaApUd299ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJ7XGxpc3R0ZXh0XHBhcmRccGxhaW4gIDMuXHRhYn1caWx2bDBcbHMxIFxmaS0zNjBcbGk3MjBcbGluNzIwXHNsMjQwXHNsbXVsdDFccWx7XHJ0bGNoXGFpMFxhYjAgXGx0cmNoXGxvY2hcY2YxXGkwXHVsbm9uZVx1bGMwXGIwXGxvY2gKVGhyZWV9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJcc2wyNDBcc2xtdWx0MVxxbFxydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoCgpccGFyIFxwYXJkXHBsYWluIFxzMFxydGxjaFxhZjlcYWZzMjRcYWxhbmcxMDgxIFxsdHJjaFxsYW5nMTAzM1xsYW5nZmUyMDUyXGhpY2hcYWYzXGxvY2hccWxcd2lkY3RscGFyXGh5cGhwYXIwXGx0cnBhclxjZjBcZjNcZnMyNFxsYW5nMTAzM1xrZXJuaW5nMVxkYmNoXGFmOFxsYW5nZmUyMDUyXHNsMjQwXHNsbXVsdDFccWx7XHJ0bGNoXGFpMFxhYjAgXGx0cmNoXGxvY2hcY2YxXGkwXHVsbm9uZVx1bGMwXGIwXGxvY2gKXHRhYiBFZHdhcmQgYnkgdGhlIGdyYWNlIG9mIEdvZCBLaW5nIG9mIEVuZ2xhbmQsIGxvcmQgb2YgSXJlbGFuZCBhbmQgZHVrZSBvZiBBcXVpdGFpbmUgc2VuZHMgZ3JlZXRpbmdzIHRvIGFsbCB0byB3aG9tIHRoZSBwcmVzZW50IGxldHRlcnMgY29tZS4gV2UgaGF2ZSBpbnNwZWN0ZWQgdGhlIGdyZWF0IGNoYXJ0ZXIgb2YgdGhlIGxvcmQgSGVucnksIGxhdGUgS2luZyBvZiBFbmdsYW5kLCBvdXIgZmF0aGVyLCBjb25jZXJuaW5nIHRoZSBsaWJlcnRpZXMgb2YgRW5nbGFuZCBpbiB0aGVzZSB3b3Jkczp9ClxwYXIgXHBhcmRccGxhaW4gXHMwXHJ0bGNoXGFmOVxhZnMyNFxhbGFuZzEwODEgXGx0cmNoXGxhbmcxMDMzXGxhbmdmZTIwNTJcaGljaFxhZjNcbG9jaFxxbFx3aWRjdGxwYXJcaHlwaHBhcjBcbHRycGFyXGNmMFxmM1xmczI0XGxhbmcxMDMzXGtlcm5pbmcxXGRiY2hcYWY4XGxhbmdmZTIwNTJcc2wyNDBcc2xtdWx0MVxxbHtccnRsY2hcYWkwXGFiMCBcbHRyY2hcbG9jaFxjZjFcaTBcdWxub25lXHVsYzBcYjBcbG9jaApcdGFiIH0KXHBhciBccGFyZFxwbGFpbiBcczBccnRsY2hcYWY5XGFmczI0XGFsYW5nMTA4MSBcbHRyY2hcbGFuZzEwMzNcbGFuZ2ZlMjA1MlxoaWNoXGFmM1xsb2NoXHFsXHdpZGN0bHBhclxoeXBocGFyMFxsdHJwYXJcY2YwXGYzXGZzMjRcbGFuZzEwMzNca2VybmluZzFcZGJjaFxhZjhcbGFuZ2ZlMjA1MlxzbDI0MFxzbG11bHQxXHFse1xydGxjaFxhaTBcYWIwIFxsdHJjaFxsb2NoXGNmMVxpMFx1bG5vbmVcdWxjMFxiMFxsb2NoClx0YWIgSGVucnkgYnkgdGhlIGdyYWNlIG9mIEdvZCBLaW5nIG9mIEVuZ2xhbmQsIGxvcmQgb2YgSXJlbGFuZCwgZHVrZSBvZiBOb3JtYW5keSBhbmQgQXF1aXRhaW5lIGFuZCBjb3VudCBvZiBBbmpvdSBzZW5kcyBncmVldGluZ3MgdG8gaGlzIGFyY2hiaXNob3BzLCBiaXNob3BzLCBhYmJvdHMsIHByaW9ycywgZWFybHMsIGJhcm9ucywgc2hlcmlmZnMsIHJlZXZlcywgbWluaXN0ZXJzIGFuZCBhbGwgaGlzIGJhaWxpZmZzIGFuZCBmYWl0aGZ1bCBtZW4gaW5zcGVjdGluZyB0aGUgcHJlc2VudCBjaGFydGVyLiBLbm93IHRoYXQgd2UsIGF0IHRoZSBwcm9tcHRpbmcgb2YgR29kIGFuZCBmb3IgdGhlIGhlYWx0aCBvZiBvdXIgc291bCBhbmQgdGhlIHNvdWxzIG9mIG91ciBhbmNlc3RvcnMgYW5kIHN1Y2Nlc3NvcnMsIGZvciB0aGUgZ2xvcnkgb2YgaG9seSBDaHVyY2ggYW5kIHRoZSBpbXByb3ZlbWVudCBvZiBvdXIgcmVhbG0sIGZyZWVseSBhbmQgb3V0IG9mIG91ciBnb29kIHdpbGwgaGF2ZSBnaXZlbiBhbmQgZ3JhbnRlZCB0byB0aGUgYXJjaGJpc2hvcHMsIGJpc2hvcHMsIGFiYm90cywgcHJpb3JzLCBlYXJscywgYmFyb25zIGFuZCBhbGwgb2Ygb3VyIHJlYWxtIHRoZXNlIGxpYmVydGllcyB3cml0dGVuIGJlbG93IHRvIGhvbGQgaW4gb3VyIHJlYWxtIG9mIEVuZ2xhbmQgaW4gcGVycGV0dWl0eX0KXHBhciB9";

describe('whitespace tests', () => {
	test('trimming whitespace only preserves other special characters (1)', () => {
		const res = trimWhitespace(" hello\n");
		expect(res).toEqual("hello\n");
	});

	test('trimming whitespace only preserves other special characters (2)', () => {
		const res = trimWhitespace("           hello\n      ");
		expect(res).toEqual("hello\n");
	});

	test('trimming whitespace only preserves other special characters (2)', () => {
		const res = trimWhitespace(" \thi there\n ");
		expect(res).toEqual("\thi there\n");
	});
});

// describe('docx processing tests', async () => {
// 	test('reading in first test docx document', async () => {
// 		const testDocxFile = await readDocx("../../files/article.docx");
// 		expect(testDocxFile).toBe("This is a test!");
// 	});

// 	test('reading in second test docx document', async () => {
// 		const docxContent = Buffer.from(docxText2, 'base64').toString('utf8');
// 		jest.spyOn(ipc, 'read').mockResolvedValue(docxContent);
// 		const content = await loadDocxFile("./docs/test2.docx");
// 		expect(content).toBe(`This is a test!
// 	});
// });

describe('rtf processing tests', () => {
	test('trimming whitespace only preserves other special characters (2)', () => {
		const testStrings = [
			"\\u8211?-",
			"\\u8211\\'2d",
			"\\u8221\\'94",
			"\\u8217\\'92s access to advanced technologies",
			"\\u-10179",
			"\\u8211?- \\u8220\\'93This is a test\\u8221\\'94.",
			"The quick brown fox jumps over the lazy dog \\u8212.",
			"\\u8218\\'92nd chance for success.",
			"\\u8211 ? - This is unusual.",
			"\\u8211\\'2d\\b Bold text\\b0.",
			"\\u This is invalid.",
			"\\u8221?--",
			"Start of sentence \\u8211 with dash, \\u201C\\'93quoted text\\u201D\\'94 end.",
			"\\u2026\\'85Ellipsis at start and end\\u2026",
			"This \\\\u8211 isn't a Unicode sequence."
		];

		expect(processRTFContent(testStrings[0])).toEqual("\\u8211");
		expect(processRTFContent(testStrings[1])).toEqual("\\u8211");
		expect(processRTFContent(testStrings[2])).toEqual("\\u8221");
		expect(processRTFContent(testStrings[3])).toEqual("\\u8217s access to advanced technologies");
		expect(processRTFContent(testStrings[4])).toEqual("\\u-10179");
		expect(processRTFContent(testStrings[5])).toEqual("\\u8211 \\u8220This is a test\\u8221.");
		expect(processRTFContent(testStrings[6])).toEqual("The quick brown fox jumps over the lazy dog \\u8212.");
		expect(processRTFContent(testStrings[7])).toEqual("\\u8218nd chance for success.");
		expect(processRTFContent(testStrings[8])).toEqual("\\u8211 This is unusual.");
		expect(processRTFContent(testStrings[9])).toEqual("\\u8211\\b Bold text\\b0.");
		expect(processRTFContent(testStrings[10])).toEqual("\\u This is invalid.");
		expect(processRTFContent(testStrings[11])).toEqual("\\u8221-");
		expect(processRTFContent(testStrings[12])).toEqual("Start of sentence \\u8211 with dash, \\u201Cquoted text\\u201D end.");
		expect(processRTFContent(testStrings[13])).toEqual("\\u2026Ellipsis at start and end\\u2026");
		expect(processRTFContent(testStrings[14])).toEqual("This \\\\u8211 isn't a Unicode sequence.");
	});

	test('reading in first test RTF document', async () => {
		const rtfContent = Buffer.from(rtfText1, 'base64').toString('utf8');
		jest.spyOn(ipc, 'read').mockResolvedValue(rtfContent);
		const content = await loadRtfFile("./docs/test1.rtf");
		expect(content).toBe("This");
	});

	test('reading in second test RTF document', async () => {
		const rtfContent = Buffer.from(rtfText2, 'base64').toString('utf8');
		jest.spyOn(ipc, 'read').mockResolvedValue(rtfContent);
		const content = await loadRtfFile("./docs/test1.rtf");
		expect(content).toBe(`This is a test!
Font size
highlight
colored text
BOLD
Italicized
New font
Underlined
Edward by the grace of God King of England, lord of Ireland and duke of Aquitaine sends greetings to all to whom the present letters come. We have inspected the great charter of the lord Henry, late King of England, our father, concerning the liberties of England in these words: Henry by the grace of God King of England, lord of Ireland, duke of Normandy and Aquitaine and count of Anjou sends greetings to his archbishops, bishops, abbots, priors, earls, barons, sheriffs, reeves, ministers and all his bailiffs and faithful men inspecting the present charter. Know that we, at the prompting of God and for the health of our soul and the souls of our ancestors and successors, for the glory of holy Church and the improvement of our realm, freely and out of our good will have given and granted to the archbishops, bishops, abbots, priors, earls, barons and all of our realm these liberties written below to hold in our realm of England in perpetuity
center formatted
Right formattedIndented!
Double spacingNumbered list:1. 	 One2. 	 Two3. 	 Three
	 Edward by the grace of God King of England, lord of Ireland and duke of Aquitaine sends greetings to all to whom the present letters come. We have inspected the great charter of the lord Henry, late King of England, our father, concerning the liberties of England in these words:		 Henry by the grace of God King of England, lord of Ireland, duke of Normandy and Aquitaine and count of Anjou sends greetings to his archbishops, bishops, abbots, priors, earls, barons, sheriffs, reeves, ministers and all his bailiffs and faithful men inspecting the present charter. Know that we, at the prompting of God and for the health of our soul and the souls of our ancestors and successors, for the glory of holy Church and the improvement of our realm, freely and out of our good will have given and granted to the archbishops, bishops, abbots, priors, earls, barons and all of our realm these liberties written below to hold in our realm of England in perpetuity`);
	});

	test('reading in invalid RTF document', async () => {
		const rtfContent = Buffer.from("invalid rtf format", 'base64').toString('utf8');
		jest.spyOn(ipc, 'read').mockResolvedValue(rtfContent);
	    const content = await loadRtfFile("./docs/invalid.rtf");
	    expect(content).toBeUndefined();
	});
});